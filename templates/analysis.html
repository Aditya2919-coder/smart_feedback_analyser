<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Feedback Analysis</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    padding: 20px;
    background: #f4f6f8;
  }
  h3 {
    text-align: center;
    margin-bottom: 20px;
  }
  .stats {
    display: flex;
    justify-content: space-around;
    margin-bottom: 30px;
    flex-wrap: wrap;
  }
  .stat-box {
    background: white;
    padding: 15px 25px;
    border-radius: 8px;
    box-shadow: 0 3px 10px rgba(0,0,0,0.1);
    text-align: center;
    margin: 10px;
    flex: 1 1 200px;
  }
  canvas {
    background: white;
    border-radius: 8px;
    padding: 10px;
    margin-bottom: 30px;
  }
  .btn-back {
    display: block;
    margin: 20px auto;
    padding: 10px 20px;
    background-color: #007ab8;
    color: white;
    border: none;
    border-radius: 6px;
    font-weight: bold;
    cursor: pointer;
    text-align: center;
  }
  .btn-back:hover {
    background-color: #005f87;
  }
</style>
</head>
<body>

<h3>Feedback Analysis</h3>

<div class="stats">
  <div class="stat-box">
    <h4>Total Feedback</h4>
    <p>{{ total_feedback }}</p>
  </div>
  <div class="stat-box">
    <h4>Average Rating</h4>
    <p>{{ avg_rating }}</p>
  </div>
  <div class="stat-box">
    <h4>Places Visited</h4>
    <p>{{ places_count }}</p>
  </div>
</div>

<canvas id="ratingsChart"></canvas>

<!-- Back to Dashboard Button -->
<a href="/tourist_dashboard?uid={{ user['id'] }}">ðŸ“Š View Feedback Analysis</a>

<script>
// Redirect to dashboard
function goDashboard() {
    window.location.href = '/tourist/dashboard?uid={{ user }}'; // replace URL if needed
}

// Ratings chart
const ratings = JSON.parse('{{ ratings|safe }}');

const ctxRatings = document.getElementById("ratingsChart").getContext("2d");
new Chart(ctxRatings, {
  type: 'bar',
  data: {
    labels: ['1 Star','2 Stars','3 Stars','4 Stars','5 Stars'],
    datasets: [{
      label: 'Number of Ratings',
      data: ratings,
      backgroundColor: 'rgba(0,224,255,0.6)',
      borderColor: '#00e0ff',
      borderWidth: 2,
      borderRadius: 6
    }]
  },
  options: {
    responsive: true,
    plugins: { legend: { display: false } },
    scales: { y: { beginAtZero: true } }
  }
});
</script>

</body>
</html>
